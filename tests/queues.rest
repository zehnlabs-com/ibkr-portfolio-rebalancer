###
# Management Service Queue API Tests
# Base URL: http://localhost:8000
###

@baseUrl = http://localhost:8000
@apiKey = 8F3A-7C2D-9B1E-4G5H

###
# Health Check Endpoints (Public)
###

### Basic Health Check
GET {{baseUrl}}/health

### Detailed Health Check
GET {{baseUrl}}/health/detailed

###
# Queue Status Endpoints (Public)
###

### Get Queue Status
GET {{baseUrl}}/queue/status

### Get All Queue Events (Active + Delayed)
GET {{baseUrl}}/queue/events

### Get Queue Events with Limit
GET {{baseUrl}}/queue/events?limit=50

### Get Active Events Only
GET {{baseUrl}}/queue/events?type=active

### Get Delayed Events Only
GET {{baseUrl}}/queue/events?type=delayed

### Get Active Events with Limit
GET {{baseUrl}}/queue/events?limit=10&type=active

### Get Delayed Events with Limit
GET {{baseUrl}}/queue/events?limit=10&type=delayed


### Remove Event by ID (replace with actual event ID)
DELETE {{baseUrl}}/queue/events/f6aeccde-9f06-42a7-9c01-1485d66e8a5b
Authorization: Bearer {{apiKey}}

###
# Error Testing
###

### Test Invalid Event Type
GET {{baseUrl}}/queue/events?type=invalid

### Test Add Event Without API Key
POST {{baseUrl}}/queue/events
Content-Type: application/json

{
  "account_id": "DU123456",
  "exec_command": "rebalance",
  "data": {
    "exec": "rebalance"
  }
}

### Test Remove Event Without API Key
DELETE {{baseUrl}}/queue/events/some-event-id

### Test Add Event with Invalid Data
POST {{baseUrl}}/queue/events
Authorization: Bearer {{apiKey}}
Content-Type: application/json

{
  "account_id": "",
  "exec_command": "",
  "data": {}
}

### Test Remove Non-existent Event
DELETE {{baseUrl}}/queue/events/non-existent-event-id
Authorization: Bearer {{apiKey}}

###
# Monitoring Workflows
###

### Check System Health
GET {{baseUrl}}/health

### Monitor Queue Status
GET {{baseUrl}}/queue/status

### View All Events
GET {{baseUrl}}/queue/events

### View Only Problematic Events (Delayed)
GET {{baseUrl}}/queue/events?type=delayed

### View Recent Events
GET {{baseUrl}}/queue/events?limit=10

###
# Common Troubleshooting Workflows
###

### Step 1: Check Overall Health
GET {{baseUrl}}/health

### Step 2: Get Queue Metrics
GET {{baseUrl}}/queue/status

### Step 3: View All Events
GET {{baseUrl}}/queue/events?limit=100

### Step 4: Check Delayed Events
GET {{baseUrl}}/queue/events?type=delayed

### Step 5: View Active Events
GET {{baseUrl}}/queue/events?type=active

###
# Example Multi-Account Testing
###

### Add Event for Second Account
POST {{baseUrl}}/queue/events
Authorization: Bearer {{apiKey}}
Content-Type: application/json

{
  "account_id": "DU789012",
  "exec_command": "rebalance",
  "data": {
    "exec": "rebalance"
  }
}

### Add Different Command for Same Account
POST {{baseUrl}}/queue/events
Authorization: Bearer {{apiKey}}
Content-Type: application/json

{
  "account_id": "DU123456",
  "exec_command": "print-positions",
  "data": {
    "exec": "print-positions"
  }
}

###
# Root Endpoint
###

### Service Info
GET {{baseUrl}}/